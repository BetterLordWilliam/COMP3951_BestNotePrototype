<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:views="clr-namespace:BestNote_3951.Views"
             x:Class="BestNote_3951.Views.BestFileTreeView"
             x:Name="this">

    <!--
    <CollectionView x:Name="SubFilesCollectionView" IsVisible="False" ItemsSource="{Binding SubFiles}">
        <CollectionView.ItemTemplate>
            <DataTemplate>
                <views:BestFileTreeView BestFile="{Binding .}"/>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView> -->
    
    <VerticalStackLayout>
        <!-- File Information -->
        <HorizontalStackLayout Margin="{Binding IndentationPadding}"
                               HeightRequest="20">
            <Image Source="{Binding ImageIcon}" />
            <Label Text="{Binding ItemName}" VerticalTextAlignment="Center" />
            <HorizontalStackLayout.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnToggleClicked" />
            </HorizontalStackLayout.GestureRecognizers>
        </HorizontalStackLayout>

            <!-- Recursive Subfile List -->
        <CollectionView x:Name="SubFilesCollectionView" IsVisible="True" ItemsSource="{Binding SubFiles}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <views:BestFileTreeView BestFile="{Binding .}"/>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        <!-- Context View To add File to this node -->
        <FlyoutBase.ContextFlyout>
            <MenuFlyout>
                <MenuFlyoutItem Text="Add Subfolder" Command="{Binding BindingContext.AddFolderCommand, Source={RelativeSource AncestorType={x:Type views:FileStructureView}}}" CommandParameter="{Binding .}" />
                <MenuFlyoutItem Text="Add Note" Command="{Binding BindingContext.AddFileCommand, Source={RelativeSource AncestorType={x:Type views:FileStructureView}}}" CommandParameter="{Binding .}" />
            </MenuFlyout>
        </FlyoutBase.ContextFlyout>
    </VerticalStackLayout>

</ContentView>
